/**
 * @file    ws2812b.c
 * @author  Jorge Guzman
 * @date    Fev 7, 2019
 * @brief   Bibliteoca para o uso dos Leds ws2812b
 * @details configurar pwm com com o valor de 800KHz.
 *
 */

//==============================================================================
// CHECK TO ENABLE LIBRARY
//==============================================================================
#include "ws2812b.h"
#if defined(HAL_SPI_MODULE_ENABLED)    & \
	defined(MIDDLEWARE_WS2812B_ENABLED)

//==============================================================================
// INCLUDE FILES
//==============================================================================

//==============================================================================
// PRIVATE DEFINITIONS
//==============================================================================

//==============================================================================
// PRIVATE TYPEDEFS
//==============================================================================

typedef struct
{
	SPI_HandleTypeDef *spi;
} WS2812BDrv_t;

//==============================================================================
// PRIVATE VARIABLES
//==============================================================================

WS2812BDrv_t ws2812Control =
{ .spi = NULL, };

//==============================================================================
// PRIVATE FUNCTIONS
//==============================================================================

//==============================================================================
// PRIVATE FUNCTIONS
//==============================================================================

//==============================================================================
// PRIVATE SOURCE CODE
//==============================================================================

//==============================================================================
// PUBLIC SOURCE CODE
//==============================================================================

HAL_StatusTypeDef ws2812b_write(uint8_t *data, uint16_t size)
{
	HAL_StatusTypeDef resp;

	resp = HAL_ERROR;

	if (ws2812Control.spi != NULL)
	{
		resp = HAL_SPI_Transmit(ws2812Control.spi, data, size, HAL_MAX_DELAY);
	}

	return resp;
}

HAL_StatusTypeDef ws2812b_spi_attach(SPI_HandleTypeDef *spi)
{
	if (spi != NULL)
	{
		ws2812Control.spi = spi;

		return HAL_OK;
	}

	return HAL_ERROR;
}

#endif /* MIDDLEWARE_WS2812B_ENABLED */
